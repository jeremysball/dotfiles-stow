#!/usr/bin/env bash

# source: https://github.com/i3/i3/discussions/6132

# bash strict mode :https://gist.github.com/mohanpedala/1e2ff5661761d3abd0385e8223e16425
# set -euox pipefail
# IFS=$'\n\t'

(
	win_id="$(xdotool getactivewindow)"

  parent_pid=$(xdotool getwindowpid "$win_id")

    # One alacritty process can have multiple windows, each with a different shell in different working directory. Go
    # through each process and if the special ALACRITTY_WINDOW_ID matches the currently focused window id, re-use that
    # directory.

  shell_pwd="$(readlink -f /proc/"$pid"/cwd)"
  [[ -d "$shell_pwd" ]] || false 
  exec kitty --directory "$shell_pwd" || false
) || exec kitty



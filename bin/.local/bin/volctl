#!/usr/bin/env bash

run() {
  step=5
  show_ms=300
  hostname=$(hostnamectl hostname)
  notf_txt="$(wpctl get-volume @DEFAULT_SINK@ | rg '(Volume:)\s?(?:\d\.)(\d{2})\s?(\[*\w*\]?)' -or '$1 $2 $3')" 
  lvl=$(wpctl get-volume @DEFAULT_SINK@ | rg "(Volume:)\s?(?:\d\.)(\d{2})\s?(\[*\w*\]?)" -or '$2')

    case "$1" in
      "up")
        if [[ $lvl -lt "$((100 - ($step + 1)))" ]]; then
          wpctl set-volume @DEFAULT_SINK@ "$step%+"
        fi
      ;;
      "down")
        wpctl set-volume @DEFAULT_SINK@ "$step%-"
      ;;
      "mute")
        wpctl set-mute @DEFAULT_SINK@ toggle
      ;;
    esac
  $(notify-send -t "$show_ms" "$hostname" "$notf_txt")
}

run $@
